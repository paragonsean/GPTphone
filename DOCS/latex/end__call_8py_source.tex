\doxysection{end\+\_\+call.\+py}
\hypertarget{end__call_8py_source}{}\label{end__call_8py_source}\index{/Users/seanbaker/Downloads/GPTPhone (2)/functions/end\_call.py@{/Users/seanbaker/Downloads/GPTPhone (2)/functions/end\_call.py}}
\mbox{\hyperlink{end__call_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00001}\mbox{\hyperlink{namespaceend__call}{00001}}\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00002}00002\ \textcolor{keyword}{from}\ twilio.rest\ \textcolor{keyword}{import}\ Client}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00003}00003\ \textcolor{keyword}{import}\ asyncio}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00004}00004\ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00005}00005\ \textcolor{stringliteral}{Author:\ Sean\ Baker}}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00006}00006\ \textcolor{stringliteral}{Date:\ 2024-\/07-\/08\ }}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00007}00007\ \textcolor{stringliteral}{Description:\ terminates\ call\ }}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00008}00008\ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00009}\mbox{\hyperlink{namespaceend__call_a8bf08dfce1aad71ae59e6bff78f4cc82}{00009}}\ \textcolor{keyword}{async\ def\ }\mbox{\hyperlink{namespaceend__call}{end\_call}}(context,\ args):}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00010}00010\ \ \ \ \ \textcolor{comment}{\#\ Retrieve\ the\ Twilio\ credentials\ from\ environment\ variables}}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00011}00011\ \ \ \ \ account\_sid\ =\ os.environ[\textcolor{stringliteral}{'TWILIO\_ACCOUNT\_SID'}]}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00012}00012\ \ \ \ \ auth\_token\ =\ os.environ[\textcolor{stringliteral}{'TWILIO\_AUTH\_TOKEN'}]}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00013}00013\ \ \ \ \ client\ =\ Client(account\_sid,\ auth\_token)}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00014}00014\ \ \ \ \ call\_sid\ =\ context.call\_sid}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00016}00016\ \ \ \ \ \textcolor{comment}{\#\ Fetch\ the\ call}}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00017}00017\ \ \ \ \ call\ =\ client.calls(call\_sid).fetch()}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00019}00019\ \ \ \ \ \textcolor{comment}{\#\ Check\ if\ the\ call\ is\ already\ completed}}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00020}00020\ \ \ \ \ \textcolor{keywordflow}{if}\ call.status\ \textcolor{keywordflow}{in}\ [\textcolor{stringliteral}{'completed'},\ \textcolor{stringliteral}{'failed'},\ \textcolor{stringliteral}{'busy'},\ \textcolor{stringliteral}{'no-\/answer'},\ \textcolor{stringliteral}{'canceled'}]:}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00021}00021\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ f\textcolor{stringliteral}{"{}Call\ already\ ended\ with\ status:\ \{call.status\}"{}}}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00023}00023\ \ \ \ \ \textcolor{comment}{\#\ Wait\ for\ 5\ seconds\ before\ ending\ the\ call\ to\ ensure\ the\ goodbye\ goes\ through}}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00024}00024\ \ \ \ \ await\ asyncio.sleep(5)}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00026}00026\ \ \ \ \ \textcolor{comment}{\#\ End\ the\ call}}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00027}00027\ \ \ \ \ call\ =\ client.calls(call\_sid).update(status=\textcolor{stringliteral}{'completed'})}
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{end__call_8py_source_l00029}00029\ \ \ \ \ \textcolor{keywordflow}{return}\ f\textcolor{stringliteral}{"{}Call\ ended\ successfully.\ Final\ status:\ \{call.status\}"{}}}

\end{DoxyCode}
